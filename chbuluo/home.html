<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title></title>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta http-equiv="Expires" content="0">
    <meta http-equiv="Pragma" content="no-cache">
    <meta http-equiv="Cache-control" content="no-cache">
    <meta http-equiv="Cache" content="no-cache">
    <meta name="viewport"
          content="initial-scale=1, width=device-width, height=device-height, viewport-fit=cover, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="csrf-param" content="_csrf-frontend">
    <meta name="csrf-token" content="bXpvY3lwS2I9LgYoLRkpExVKOTEhGxQLJgIjGxIbfD1dICU5PAYZEw==">
    <meta name="keywords" content="部落格">
    <meta name="description" content="部落格">
    <link href="./assets/css/main.css" rel="stylesheet">
    <script src="./assets/js/jquery-1.7.2.min.js"></script>
    <script src="./assets/js/base.js"></script>
    <script src="./assets/js/slider.js"></script>
    <link rel="stylesheet" href="./assets/css/slider.css">
</head>
<body>
<header>
    <span class="bg-logo" onclick="window.location.href='index.html'">
        <img id="bg-logo" src="" onerror="this.src='./assets/imgs/error.jpg'" alt="">
    </span>
    <span class="bg-menu" onclick="window.location.href='keyword.html'"></span>
</header>
<section>
    <div class="container">
        <div class="slider-container">
            <div class="slider">
            </div>
        </div>
    </div>
    <div class="notice">
        <img src="./assets/imgs/b-notice.png" alt=""/>
        <span class="notice_kind"></span>
        <span class="notice_nec"></span>
    </div>
</section>
<div style="height:5px;background: #eaeaea;"></div>

<section>
    <div class="detail_kind">
        <h3>北京赛车</h3>
    </div>

    <div class="c_item">
    </div>

    <div class="more_div" style="display: none;"><span onclick="search(cid)">更多</span></div>
</section>
</body>
<script>
    var cid = "";
    var cName = "";
    // <!--初始化文章分类检索-->
    $(document).ready(function () {
        setConfiguration();
        getBanners();
        cid = window.location.href.split("id=")[1];
        cName = decodeURI(window.location.href.split("name=")[1].split("&")[0]);
        $(".detail_kind h3").text(cName);
        if (cid === undefined || cid.trim() === "") return;
        search(cid);
    });
    //文章分类检索结果分页
    var pages = {
        page: 1,
        pageSize: 10,
        total: 20,
        hasNext: true
    };
    //检索文章分类
    var search = function (val) {
        $.ajax({
            url: apiUrl + "/v1/h5/blog/article-list",
            type: "get",
            dataType: "json",
            data: {id: val, page: pages.page, per_page: pages.pageSize},
            success: function (rs) {
                if (rs) {
                    var data = rs.data;
                    // var rPages = data['pages'];
                    var c_item = "";
                    if (data.length > 0) {
                        data.forEach(function (v) {
                            c_item += "<div class='item'>\n" +
                                "<a href='detail.html?id=" + v['id'] + "'>\n" +
                                "<img src='" + v['cover_plan'] + "' onerror='this.src=\"./assets/imgs/error.jpg\"' style='width: 80px;height: 80px;border-radius: 5px;' alt=''/>\n" +
                                "<div class='content_box'>\n" +
                                "<h3>" + v['title'] + "</h3>\n" +
                                "<p>" + v['description'] + "</p>\n" +
                                "</div>\n" +
                                "</a>\n" +
                                "</div>";
                        });
                    } else {
                        c_item += "<div class='item'>暂时没有数据</div>";
                    }
                    $(".c_item").append(c_item);
                    pages.hasNext = rs.current_page * rs.per_page < rs.total;
                    if (pages.hasNext) {
                        pages.page++;
                        $(".more_div").show();
                    } else {
                        $(".more_div").hide();
                    }
                } else {
                    alert(rs.msg);
                }
            }, err: function (err) {
                alert(err);
            }
        });
    };

    //设置网站配置
    function setConfiguration() {
        var site_name = localStorage.getItem("site_name");
        var site_icon = localStorage.getItem("site_icon");
        var site_logo = localStorage.getItem("site_logo");
        var site_lead = localStorage.getItem("site_lead");
        var site_fdata = localStorage.getItem("site_fdata");
        site_fdata = JSON.parse(site_fdata);
        document.title = site_name;
        setFavicon(site_icon);
        $("#bg-logo").attr("src", site_logo);
        $(".notice_kind").html(site_lead);  //业界头条
        $(".notice_nec").click(function () {
            window.location.href = "detail.html?id=" + site_fdata['id'];
        }).html(site_fdata['title']);

    }
</script>
</html>